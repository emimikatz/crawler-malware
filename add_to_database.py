#!/usr/bin/env python

from pymongo import MongoClient
from collections import OrderedDict
import sys
from init_database import *
""" _id:objectId
    id_malware:string
    source_malware:string
    date_added_malware:date
    url_malware:string
    url_status_malware: bool
    threat_malware:string
    tags_malware:string
    url_haus_malware:string
    reporter_malware:string
    md5_malware:string
    sha256_malware:string
    sha1_malware:string
    ssdeep_malware:string
    is_exe_malware:bool
    imphash_malware:string
    rapport_vt_malware:objectId
    ip_malware:objectId"""

def add_malware_table(id_malware, source_malware, date_added, url_malware, url_status, threat, tags, urlhaus_link, reporter):

    try:
        print(id_malware)
        print(source_malware)
        print(date_added)
        print(url_malware)
        print(url_status)
        print(threat)
        print(tags)
        print(urlhaus_link)
        print(reporter)
        db = connect_database()
        query = {"id_malware":id_malware,
                 "source_malware":source_malware,
                 "date_added_malware":date_added,
                 "url_malware":url_malware,
                 "url_status_malaware":url_status,
                 "threat_malware": threat,
                 "tags_malware": tags,
                 "urlhaus_link_malware":urlhaus_link,
                 "reporter_malware":reporter
        }
        db.malware_collection.insert(query)
        print("All good.")
    except:
        print("exc:", sys.exc_info())
