import urllib.request
import os
import hashlib
import ssdeep
import pefile
import json
import requests
from init_connection import *
from init_database import *

from virustotal_python import Virustotal

dir_path = os.path.dirname(os.path.realpath(__file__))

def parse_urlhaus(db,request):
    
    parse_csv_urlhaus(db, request)


def main():

    val = input("enter value\n")
    if val == "download":
        db = connect_database()
        request = init_connection_urlhaus()
        parse_urlhaus(db, request)
        print_database(db)
        print_gridfs(db)
    elif val == "clean":
        init_mongo()
        db = connect_database()
        erase_gridfs(db)
        print_database(db)
        print_gridfs(db)
    elif val == "count":
        db = connect_database()
        count_gridfs(db)
        count_database(db)
    elif val == "print":
        db = connect_database()
        print_gridfs(db)
        print_database(db)


if __name__ == "__main__":
    main()
