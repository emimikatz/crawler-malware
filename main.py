#!/usr/bin/env python

import os
import time

from init_connection import *
from init_database import *
from vt_process import * 

from threading import Thread 

dir_path = os.path.dirname(os.path.realpath(__file__))

def main():

    input_user = input("Enter value\n")
    print("Enter 'run' to download files from urlhaus")
    print("Enter 'init' to initializate the database")
    print("Enter 'print' to print the database")
    print("Enter 'count' to count everything in database")
    
    client, db = connect_database() 

    if input_user == "init":
        init_mongo()
    elif input_user == "run":
        Thread(target=periodic_vt, daemon=True).start()
        request = init_connection_urlhaus()
        parse_csv_urlhaus(db, request)
    elif input_user == "count":
        count_gridfs(db)
        count_database(db)
    elif input_user == "print":
        print_gridfs(db)
        print_database(db)

    client.close()


if __name__ == "__main__":
    main()
