db.createCollection("malware_table", {
   validator: {
      $jsonSchema: {
         bsonType: "object",
         required: [ "id_malware" ],
         properties: {
            _id : {
 	       bsonType: "objectId",
	    },
	    id_malware : {
 	       bsonType: "double",
	    },
	    source_malware : {
 	       bsonType: "string",
	    },
	    date_added_malware : {
 	       bsonType: "date",
	    },
	    url_malware : {
 	       bsonType: "string",
	    },
	    url_status_malware : {
 	       bsonType: "bool",
	    },
	    threat_malware : {
 	       bsonType: "string",
	    },
	    tags_malware : {
 	       bsonType: "string",
	    },
	    url_haus_malware : {
 	       bsonType: "string",
	    },
	    reporter_malware : {
 	       bsonType: "string",
	    },
	    md5_malware : {
 	       bsonType: "string",
	    },
	    sha256_malware : {
 	       bsonType: "string",
	    },
	    sha1_malware : {
 	       bsonType: "string",
	    },
	    ssdeep_malware : {
 	       bsonType: "string",
	    },
	    is_exe_malware : {
 	       bsonType: "bool",
	    },
	    imphash_malware : {
 	       bsonType: "string",
	    },
	    rapport_vt_malware : {
 	       bsonType: "objectId",
	    },
	    ip_malware : {
 	       bsonType: "objectId",
	    }
	 }
      }
   }
}

db.createCollection("vt_table", {
   validator: {
      $jsonSchema: {
         bsonType: "object",
         required: [ "id_vt" ],
         properties: {
    	    _id : {
 	       bsonType: "objectId",
	    },
	    id_vt : {
 	       bsonType: "double",
	    },
	    total_scan_vt : {
 	       bsonType: "int",
	    },
	    positives_vt : {
 	       bsonType: "int",
	    },
	    resource_vt : {
 	       bsonType: "string",
	    },
	    response_vt : {
 	       bsonType: "int",
	    },
	    scan_date_vt : {
 	       bsonType: "date",
	    },
	    permalink_vt : {
 	       bsonType: "string",
	    },
	    sha256_vt : {
 	       bsonType: "string",
	    },
	    md5_vt : {
 	       bsonType: "string",
	    },
	    id_labels_vt : {
 	       bsonType: "objectId",
	    },
	    id_malware_vt : {
 	       bsonType: "objectId",
	    }
	 }
      }
   }
}

db.createCollection("label_table", {
   validator: {
      $jsonSchema: {
         bsonType: "object",
         required: [ "name_antivirus_label" ],
         properties: {
    	    _id : {
 	       bsonType: "objectId",
	    },
            name_antivirus_label : {
 	       bsonType: "string",
	    },
	    id_malware_label : {
 	       bsonType: "objectId",
	    },
	    id_vt_label : {
 	       bsonType: "objectId",
	    }
	 }
      }
   }
}

db.createCollection("ip_table", {
   validator: {
      $jsonSchema: {
         bsonType: "object",
         required: [ "adress_ip" ],
         properties: {
    	    _id : {
 	       bsonType: "objectId",
	    },
            adress_ip : {
 	       bsonType: "string",
	    },
	    mask_ip : {
 	       bsonType: "objectId",
	    },
	    domain_ip : {
 	       bsonType: "string",
	    },
	    geo_ip : {
 	       bsonType: "string",
	    },
	    registar_ip : {
 	       bsonType: "string",
	    }
	 }
      }
   }
}
